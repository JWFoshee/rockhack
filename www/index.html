<!doctype html>
<html>
<body>
<link rel="stylesheet" href="vendor/rickshaw.min.css">
<script src="vendor/d3.v3.js"></script>
<script src="vendor/rickshaw.min.js"></script>
<script src="vendor/Rickshaw.Graph.RangeSlider.Preview.js"></script>
<script src="log_json.json"></script>

<div id="chart"></div>
<div id="chart2"></div>
<div id="preview"></div>

<script>

    var graphDataFor = function(logName, color) {
        var depth = logData['DEPT'];
        var amp = logData[logName];
        if (amp.length != depth.length)
            console.log('Warning: different lengths: DEPT vs ' + logName);
        var data = [];
        for(var i = 0; i < depth.length; ++i) {
            data[i] = {y: amp[i], x: depth[i] };
        }
        return {
            color: color || 'black',
            data: data
        };
    };
    
    var graphFor = function(series, selector) {
        var graph = new Rickshaw.Graph( {
            element: document.querySelector(selector),
            width: 1280,
            height: 200,
            renderer: 'line',
            series: series
        } );
        graph.render();
        var tickFormat = Rickshaw.Fixtures.Number.formatKMBT;
        var xAxis = new Rickshaw.Graph.Axis.X({ graph: graph, tickFormat: tickFormat });
        xAxis.render();
        var yAxis = new Rickshaw.Graph.Axis.Y({ graph: graph, tickFormat: tickFormat });
        yAxis.render();
        return graph;
    };

    
    var rhob = graphDataFor('RHOB', 'red');
    var gr = graphDataFor('GR', 'yellow');
    var dphi = graphDataFor('DPHI', 'green');
    var graph = graphFor([rhob, dphi], '#chart');
    var graph2 = graphFor([gr], '#chart2');

    var preview = new Rickshaw.Graph.RangeSlider.Preview({
    	graph: graph,
    	renderer: 'line',
    	element: document.getElementById('preview'),
    });
    
    preview.onSlide(function(graph, xMin, xMax) {
		graph2.window.xMin = xMin;
		graph2.window.xMax = xMax;
		graph2.update();
    });
    
</script>
</body>
</html>
