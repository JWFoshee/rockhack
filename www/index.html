<!doctype html>
<html>
<body>
<link rel="stylesheet" href="vendor/rickshaw.min.css">
<script src="vendor/d3.v3.js"></script>
<script src="vendor/rickshaw.min.js"></script>
<script src="vendor/Rickshaw.Graph.RangeSlider.Preview.js"></script>
<script src="log_json.json"></script>

<div id="chart"></div>
<div id="preview"></div>
<div id="chart2"></div>

<script>

    var graphDataFor = function(logName, color) {
        var depth = logData['DEPT'];
        var amp = logData[logName];
        if (amp.length != depth.length)
            console.log('Warning: different lengths');    
        var data = [];
        for(var i = 0; i < depth.length; ++i) {
            data[i] = {y: amp[i], x: depth[i] };
        }
        return {
            color: color || 'black',
            data: data
        };
    };
    
    var rhob = graphDataFor('RHOB', 'red');
    var gr = graphDataFor('GR', 'yellow');
    var dphi = graphDataFor('DPHI', 'green');
    
    var graph = new Rickshaw.Graph( {
        element: document.querySelector("#chart"),
        width: 580,
        height: 250,
        renderer: 'line',
        series: [ rhob, dphi ]
    } );
    graph.render();
    
    var graph2 = new Rickshaw.Graph( {
        element: document.querySelector("#chart2"),
        width: 580,
        height: 250,
        renderer: 'line',
        series: [ gr ]
    } );
    graph2.render();
    
    var tickFormat = Rickshaw.Fixtures.Number.formatKMBT;
    var xAxis = new Rickshaw.Graph.Axis.X({ graph: graph, tickFormat: tickFormat });
    xAxis.render();
    var yAxis = new Rickshaw.Graph.Axis.Y({ graph: graph, tickFormat: tickFormat });
    yAxis.render();
    
    var preview = new Rickshaw.Graph.RangeSlider.Preview( {
    	graph: graph,
    	renderer: 'line',
    	element: document.getElementById('preview'),
    } );
    
    preview.onSlide(function(graph, xMin, xMax) {
		graph2.window.xMin = xMin;
		graph2.window.xMax = xMax;
		graph2.update();
    });
    
</script>
</body>
</html>
